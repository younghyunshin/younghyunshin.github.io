---
layout: post
title: "[부스트캠프 5기] 코드리뷰리뷰하기"
tags: [부스트캠프, 일상]
comments: true
---

> 난생 처음 코드리뷰 받아보기  

컴퓨터공학 전공자로서 n년간 코딩을 했지만 대부분 혼자 수업과제를 해결하거나 PS 공부를 하는 목적이었다. 물론 동아리 친구들과 팀프로젝트도 했지만 당시에는 우리의 코드를 봐줄 선배가 없었기 때문에 코드리뷰가 무엇인지, 얼마나 중요한지 전혀 몰랐다.

이번 부스트캠프 멤버십 학습스프린트 6주간 코드리뷰가 제공됨으로써 난생처음 내 코드를 누군가에게 보이고 평가(?) 받는 경험을 했다. 오늘은 6주동안 받은 리뷰들을 한 눈에 볼 수 있도록 모아서 내가 자주 지적받은 부분은 어떤 것인지, 잘하고 있는 것은 무엇인지 돌아보려한다.

### 변수, ViewController 파일 등의 네이밍
> SceneViewController2 와 같이 파일이나 클래스, 변수명 등을 지을때 숫자로 1,2,3 이렇게 늘리는건 나중에 코드 관리 측면에서 좋지 않습니다. 다른 이름으로 대체가 가능한지 고민을 해보시고 선택해보세요. 모두에게 어려운거라 개발자들은 이름 정하는데 가장 많은 시간을 할애한다고 하네요 ㅎㅎ

>  함수 묶음을 봤을때 Sellable이라는 단어가 적절하지 않은 것 같습니다. protocol 이름은 내부의 속성들을 아우르는 단어가 좋습니다.

역시 네이밍이 젤 어렵다 이말이야~

### Indentation 통일
> 27번째라인의 depth가 다른 라인들과 다르네요. XCode 설정에서 탭의 간격을 탭으로 할건지, 띄어쓰기로 할건지 그리고 몇 칸으로 할건지 정할 수 있어요 그런 세팅한번 알아보세요 :)

Indent의 경우 누구는 2칸, 누구는 4칸이 컨벤션이라고 은근 의견이 갈려서 리뷰어님께 질문드렸는데 "팀/개인이 정하기 나름이며 대세는 오픈소스에서 많은 쪽이 대세다, 보통 4칸 스페이스로 많이 하더라. 우리팀도 4칸이다" 라고 답해주셨다.

### if let vs. guard
> guard는 말 그대로 방어코드 입니다. 둘의 사용성은 동일하지만 언어가 주는 의도로 보통 함수가 시작하자마자 조건에 의해 return 되는 등 더이상 아래의 코드를 실행하지 않게 하는 코드에서 주로 guard를 사용합니다.

> else 구문에 return 만 있다면 guard문이 좀 더 좋을 것 같네요.

이 두 구문은 용도가 비슷해서 언제 무엇을 써야하는지, Swift만의 컨벤션은 무엇인지 전혀 몰랐는데 (지금도 많이 갈등하지만) 이 리뷰를 보고 조금 감을 잡혔다.

### 조건문의 depth
> 모든 조건문(if, guard 등등)이 3중 이상이 되면 컨트롤이 힘들어집니다. depth 를 줄이려고 노력해보세요. 이 부분은 삼항식 한 라인이나 if문 한개로 표현 가능할 것 같네요. 도전해보세요 :)

하나의 함수는 하나의 기능만 하도록! 조건문이 계속해서 중첩된다면 분기를 더 효과적으로 나누거나 더 좋은 구조를 생각해보자!

### View-Model의 분리
> Game에 CGFloat가 들어왔다는 건 잘 못 설계됐다는걸 뜻 합니다. CGFloat는 UIKit에 들어있는 객체입니다. Game같은 경우는 아이폰에서 동작하던 콘솔에서 동작하던 동일하게 활용할 수 있어야합니다. 그 결과를 이용해 아이폰에 표현할땐 UIKit을 활용하고, 콘솔에 표현할땐 Foundation 만으로도 가능하도록 해야 합니다.

아.. 6주간 받은 모든 리뷰 중에 제일 기억에 남고 나에게 유익했던 것 같다. iOS 개발을 처음 접하다보니 MVC 패턴 디자인에서 어떤 부분을 고민하고 어떤 기준으로 M-V-C를 나누어야하는지 전혀 기준이 없었다. 특히 이렇게 코드 상에서 **모델 파트에 UIKit가 import 되어있는 것만으로도 잘못된 설계**라는 것을 알 수 있다는 명확한 기준을 리뷰해주셔서 너무 좋았다. OOP, MVC에 대해서 다시한번 생각할 수 있게 해준 리뷰!

### 클로저 내부의 순환참조
> self 참조를 할때 이 큐의 내부에 긴 시간(sleep에 의해 stud 초가 걸림)이 소요된다면 strong 참조와 동일해집니다. 메모리관리에 안전하게 하려면 weak 참조를 해야할 것 같네요. 위와 같이 self를 사용하려면 중간에 main 큐에서 사용한 것 처럼 즉시 실행만 안전합니다. 클로저 캡쳐링과 weak 참조에 대해 공부해보세요.

> download라는 이름만 봐도 시간이 좀 걸릴거 같은데 내부에서 self 를 참조하고 있네요. 순환참조와 클로저 캡처를 확인해보시기 바랍니다.

하 정말 이 리뷰를 받았을 당시에는 이해를 전혀하지 못했다. 특히 "큐 내부 작업이 긴시간이 소요되는 것"과 "strong 참조가 된다는 점" 사이의 인과관계가 잘 이해가 되지 않았다. 지금에서야 해석해보자면 긴 시간이 걸리는 작업(비동기로 처리되는 작업)이 클로저로 묶여있고, 그 클로저 내부에서 self를 참조하면 순환참조로 인해 memory leak이 발생한다. 4주가 지나서야 제대로 이해했습니다 리뷰어님..!! 하하

### 강제 타입캐스팅은 지양!
> 강제 타입캐스팅을 사용하지 않으려면 어떻게 해야할까 고민해보세요

이 당시에 프로토콜 타입을 해당 프로토콜을 채택하는 클래스 타입으로 강제 캐스팅하는 코드가 많았다. 그 이유는 프로토콜 타입으로 인자를 전달해서 이를 클래스 타입으로 변환하여 처리했기 때문인데, 최상위 클래스 타입으로 전달받는 것으로 수정해서 해결했다. 앞으로도 강제 옵셔널 언래핑, 강제 타입캐스팅은 최대한 지양하는 쪽으로 코딩해야겠다.

### 고차함수 적극활용해보기
> PurchasedBeverageStackView.subviews.forEach { $0.removeFromSuperview() }

아직 C++ 스타일에 너무 익숙해서 고차함수가 바로바로 튀어나오진 않는다. 그래도 코드를 매우 간결하게 관리할 수 있으니 열심히 연습해봐야지.

### 애니메이션과 사용성
>  보통 오른쪽에서 왼쪽으로 밀고들어오는 애니메이션이 있으면 스와이프 백으로 뒤로 돌아갈 수 있을거라는 인식을 할 수 있습니다. SignUp 후 메인으로 랜딩하면 다시 돌아갈 수 없도록 하는것이 좋기 때문에 단순히 위에 덮는 것보다는 SignUp을 날리면서 랜딩하는게 좋을 것 같습니다. View Hierarchy를 확인하면서 진행해보세요.

> 움짤에서 보면 밑에쪽에 포커싱이 되었을 경우(ex: 이름) 키보드가 올라올때 나타나는 화면이 어떻게 되어야 사용하기 편할지 고민해보세요. iPhone4 같은 경우 맨 밑에 이름에 포커싱되면 무조건 키보드가 덮을텐데 다음버튼 누르는 부분 등을 신경쓰면 좋을 것 같습니다.

이 리뷰도 신선한 충격이었다! 단순히 오른쪽에서 왼쪽으로 넘어가는 애니메이션을 구현하는 데에만 신경을썼는데 애니메이션에 따른 사용자의 인식은 생각해보지 못했기 때문이다. 더해서 실제로 많은 앱에서 신경쓰지 않고 있는 키보드가 입력칸을 가리는 현상도 지적받았다. 단순히 기능을 넘어 사용성까지 생각할 수 있는 개발자가 되도록 노력해야겠다.

### 리뷰어님의 응원 한마디
> PR에 작성하시는 것처럼 앞으로 작업들을 명확하게 정의하고 기록하는 습관은 빠른 성장에 큰 도움이 될 거에요. 저도 좀 배워야겠네요 :) 앞으로도 화이팅 💪

역시 기록하는 삶! 더 성장하고 돌아오겠습니다 리뷰어님!! 😄

### 마치며
지적받은 것과 잘하고있는 부분을 돌아보려 했는데 온통 지적받은 것 뿐이다.. 하지만 앞으로 성장할 여지가 많다는 뜻이니까! `오히려 좋아(?)` 이제 다음주면 팀프로젝트가 시작된다. 사실 스프린트 기간에는 리뷰어님에게만 코드를 보여줬는데 이제 내 코드가 우리 팀 코드의 일부가 되니 더 책임감이 느껴지는 것 같다. 코드는 내가 싼 똥이고 그걸 굴리는 나는 개똥벌레.. 개똥벌레 탈출하고 사람구실하는 프로그래머가 되도록 매일매일 노력해야지!
